const express = require('express')

const ProduitModel = require('../models/produit')

// Récup router d'express
let router = express.Router()

// Middleware pour logger dates de requêtes du fichier
router.use( (req, res, next) => {
    const event = new Date()
    console.log('Produit Time:', event.toString())
    next()
})

//Routage de la ressource Produit
router.get('', (req, res) => {
    ProduitModel.findAll()
        .then( produits => res.json({data: produits}))
        .catch(err => next(err))
})

router.get('/:id',(req, res) => {
    let ProduitModelId = parseInt(req.params.id)
    //Vérif si champ id est présent & cohérent
    if(!ProduitModelId){
        return res.json(400).json({ message: 'missing parameter'})
    }
        .then( produits => res.json({data: produits}))
        .catch(err => next(err))
})

router.put('', )

router.patch('/:id', roduitCtrl.updateProduit)

router.post('/untrash/:id', roduitCtrl.untrashProduit)

router.delete('/trash/:id', roduitCtrl.trashProduit)

router.delete('/:id', roduitCtrl.deleteProduit)

module.exports = router